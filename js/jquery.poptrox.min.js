/* jquery.poptrox.js v2.5-dev | (c) n33 | n33.co | MIT licensed */
(function(e){var t="height",n="width",r="trigger",i="css",s='<iframe src="" frameborder="0" allowFullScreen="1"></iframe>',o="stopPropagation",u="position",a=!1,f="poptrox_close",l="fadeSpeed",c="length",h="text-align",p="popupNavPreviousSelector",d="poptrox_switch",v="stopSpinning",m="click",g="popupNavNextSelector",y="popupHeight",b="popupCaptionSelector",w=!0,E="popupCloserSelector",S="popupLoaderSelector",x="none",T="poptrox_previous",N="font-size",C=null,k="popupCaptionHeight",L="center",A="cursor",O="preventDefault",M="line-height",_="poptrox_reset",D="object",P="overflow",H="poptrox_next",B="popupTextColor",j="text-indent",F="pointer",I="fadeIn",q="poptrox_disableSelection",R="color",U="absolute",z="auto",W="#000000",X="load",V="100%",$="px",J="usePopupNav",K="0",Q="</div>",G="relative",Y='<div class="',Z="popupWidth",et="z-index",tt="outline",nt="startSpinning",rt="background",it="poptrox",st="40px",ot="left",ut="poptrox_open",at="popupCloserText",ft="update",lt="popupLoaderText",ct="ignore",ht="usePopupEasyClose",pt="image",dt="#FFFFFF",vt="display",mt="popupSelector",gt="soundcloud",yt="prefix",bt="useBodyOverflow",wt="type",Et="hide",St="xfin",xt="href",Tt="overlayOpacity",Nt="youtube";e.fn[q]=function(){return e(this)[i]("user-select",x)[i]("-khtml-user-select",x)[i]("-moz-user-select",x)[i]("-o-user-select",x)[i]("-webkit-user-select",x)},e.fn[it]=function(Pt){function sn(){var r,s,o,u,a,f;Rt=e(window)[n](),Ut=e(window)[t]()+Bt.windowHeightPad,r=Math.abs($t[n]()-$t.outerWidth()),s=Math.abs($t[t]()-$t.outerHeight()),o=Kt[n](),u=Kt[t](),a=Rt-Bt.windowMargin*2-r,f=Ut-Bt.windowMargin*2-s,$t[i]("min-width",Bt[Z])[i]("min-height",Bt[y]),Jt.children()[i]("max-width",a)[i]("max-height",f)}var Ht,Bt,jt,Ft,It,qt,Rt,Ut,zt,Wt,Xt,Vt,$t,Jt,Kt,Qt,Gt,Yt,Zt,en,tn,nn,rn;if(this[c]==0)return e(this);if(this[c]>1){for(Ht=0;Ht<this[c];Ht++)e(this[Ht])[it](Pt);return e(this)}return Bt=e.extend({preload:a,baseZIndex:1e3,fadeSpeed:300,overlayColor:W,overlayOpacity:.6,overlayClass:"poptrox-overlay",windowMargin:50,windowHeightPad:0,selector:"a",parent:"body",popupSpeed:300,popupWidth:200,popupHeight:100,popupIsFixed:a,useBodyOverflow:a,usePopupEasyClose:w,usePopupLoader:w,usePopupCloser:w,usePopupCaption:a,usePopupNav:a,usePopupDefaultStyling:w,popupBackgroundColor:dt,popupTextColor:W,popupLoaderTextSize:"2em",popupCloserBackgroundColor:W,popupCloserTextColor:dt,popupCloserTextSize:"20px",popupPadding:10,popupCaptionHeight:60,popupCaptionTextSize:C,popupBlankCaptionText:"(untitled)",popupCloserText:"&#215;",popupLoaderText:"&bull;&bull;&bull;&bull;",popupClass:"poptrox-popup",popupSelector:C,popupLoaderSelector:".loader",popupCloserSelector:".closer",popupCaptionSelector:".caption",popupNavPreviousSelector:".nav-previous",popupNavNextSelector:".nav-next",onPopupClose:C,onPopupOpen:C},Pt),jt=e(this),Ft=e("body"),It=e(Y+Bt.overlayClass+'"></div>'),qt=e(window),zt=[],Wt=0,Xt=a,Vt=new Array,Bt.usePopupLoader||(Bt[S]=C),Bt.usePopupCloser||(Bt[E]=C),Bt.usePopupCaption||(Bt[b]=C),Bt[J]||(Bt[p]=C,Bt[g]=C),Bt[mt]?$t=e(Bt[mt]):$t=e(Y+Bt.popupClass+'">'+(Bt[S]?'<div class="loader">'+Bt[lt]+Q:"")+'<div class="pic"></div>'+(Bt[b]?'<div class="caption"></div>':"")+(Bt[E]?'<span class="closer">'+Bt[at]+"</span>":"")+(Bt[p]?'<div class="nav-previous"></div>':"")+(Bt[g]?'<div class="nav-next"></div>':"")+Q),Jt=$t.find(".pic"),Kt=e(),Qt=$t.find(Bt[S]),Gt=$t.find(Bt[b]),Yt=$t.find(Bt[E]),Zt=$t.find(Bt[g]),en=$t.find(Bt[p]),tn=Zt.add(en),Bt.usePopupDefaultStyling&&($t[i](rt,Bt.popupBackgroundColor)[i](R,Bt[B])[i]("padding",Bt.popupPadding+$),Gt[c]>0&&($t[i]("padding-bottom",Bt[k]+$),Gt[i](u,U)[i](ot,K)[i]("bottom",K)[i](n,V)[i](h,L)[i](t,Bt[k]+$)[i](M,Bt[k]+$),Bt.popupCaptionTextSize&&Gt[i](N,popupCaptionTextSize)),Yt[c]>0&&Yt.html(Bt[at])[i](N,Bt.popupCloserTextSize)[i](rt,Bt.popupCloserBackgroundColor)[i](R,Bt.popupCloserTextColor)[i](vt,"block")[i](n,st)[i](t,st)[i](M,st)[i](h,L)[i](u,U)[i]("text-decoration",x)[i](tt,K)[i]("top",K)[i]("right","-40px"),Qt[c]>0&&Qt.html("")[i](u,G)[i](N,Bt.popupLoaderTextSize).on(nt,function(){var n=e("<div>"+Bt[lt]+Q);n[i](t,Math.floor(Bt[y]/2)+$)[i](P,"hidden")[i](M,Math.floor(Bt[y]/2)+$)[i](h,L)[i]("margin-top",Math.floor(($t[t]()-n[t]()+(Gt[c]>0?Gt[t]():0))/2))[i](R,Bt[B]?Bt[B]:"").on(St,function(){n.fadeTo(300,.5,function(){n[r]("xfout")})}).on("xfout",function(){n.fadeTo(300,.05,function(){n[r](St)})})[r](St),Qt.append(n)}).on(v,function(){var e=Qt.find("div");e.remove()}),tn[c]==2&&(tn[i](N,"75px")[i](h,L)[i](R,"#fff")[i]("text-shadow",x)[i](t,V)[i](u,U)[i]("top",K)[i]("opacity","0.35")[i](A,F)[i]("box-shadow","inset 0px 0px 10px 0px rgba(0,0,0,0)")[q](),Bt[ht]?(nn="100px",rn="100px"):(nn="75%",rn="25%"),Zt[i]("right",K)[i](n,nn).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; right: 0; margin-top: -50px;">&gt;</div>'),en[i](ot,K)[i](n,rn).html('<div style="position: absolute; height: 100px; width: 125px; top: 50%; left: 0; margin-top: -50px;">&lt;</div>'))),qt.on("resize orientationchange",function(){sn()}),Gt.on(ft,function(e,t){if(!t||t[c]==0)t=Bt.popupBlankCaptionText;Gt.html(t)}),Yt[i](A,F).on(m,function(e){return e[O](),e[o](),$t[r](f),w}),Zt.on(m,function(){$t[r](H)}),en.on(m,function(){$t[r](T)}),It[i](u,"fixed")[i](ot,0)[i]("top",0)[i](et,Bt.baseZIndex)[i](n,V)[i](t,V)[i](h,L)[i](A,F).appendTo(Bt.parent).prepend('<div style="display:inline-block;height:100%;vertical-align:middle;"></div>').append('<div style="position:absolute;left:0;top:0;width:100%;height:100%;background:'+Bt.overlayColor+";opacity:"+Bt[Tt]+";filter:alpha(opacity="+Bt[Tt]*100+');"></div>')[Et]().on("touchmove",function(){return a}).on(m,function(e){e[O](),e[o](),$t[r](f)}),Bt[ht]&&Jt[i](A,F).on(m,function(e){e[O](),e[o](),$t[r](f)}),$t[i](vt,"inline-block")[i]("vertical-align","middle")[i](u,G)[i](et,1).appendTo(It)[Et]().on(H,function(){var e=Wt+1;e>=zt[c]&&(e=0),$t[r](d,[e])}).on(T,function(){var e=Wt-1;e<0&&(e=zt[c]-1),$t[r](d,[e])}).on(_,function(){sn(),$t.data(n,Bt[Z]).data(t,Bt[y]),Qt[Et]()[r](v),Gt[Et](),Yt[Et](),tn[Et](),Jt[Et](),Kt.detach()}).on(ut,function(e,t){if(Xt)return w;Xt=w,Bt[bt]&&Ft[i](P,"hidden"),Bt.onPopupOpen&&Bt.onPopupOpen(),It.fadeTo(Bt[l],1,function(){$t[r](d,[t,w])})}).on(d,function(s,o,f){var c;if(!f&&Xt)return w;Xt=w,$t[i](n,$t.data(n))[i](t,$t.data(t)),Gt[Et](),Kt.attr("src")&&Kt.attr("src",""),Kt.detach(),c=zt[o],Kt=c[D],Kt.off(X),Jt[i](j,"-9999px").show().append(Kt),c[wt]=="ajax"?e.get(c.src,function(e){Kt.html(e),Kt[r](X)}):Kt.attr("src",c.src),c[wt]!=pt&&Kt[i](u,G)[i](tt,K)[i](et,Bt.baseZIndex+100)[n](c[n])[t](c[t]),Qt[r](nt)[I](300),$t.show(),Bt.popupIsFixed?($t[n](Bt[Z])[t](Bt[y]),Kt[X](function(){Kt.off(X),Qt[Et]()[r](v),Gt[r](ft,[c.captionText])[I](Bt[l]),Yt[I](Bt[l]),Jt[i](j,0)[Et]()[I](Bt[l],function(){Xt=a}),Wt=o,tn[I](Bt[l])})):Kt[X](function(){var e,s,u;sn(),Kt.off(X),Qt[Et]()[r](v),e=Kt[n](),s=Kt[t](),u=function(){Gt[r](ft,[c.captionText])[I](Bt[l]),Yt[I](Bt[l]),Jt[i](j,0)[Et]()[I](Bt[l],function(){Xt=a}),Wt=o,tn[I](Bt[l]),$t.data(n,e).data(t,s)[i](n,z)[i](t,z)},e==$t.data(n)&&s==$t.data(t)?u():$t.animate({width:e,height:s},Bt.popupSpeed,"swing",u)}),c[wt]!=pt&&Kt[r](X)}).on(f,function(){if(Xt)return w;Xt=w,$t[Et]()[r](_),Bt.onPopupClose&&Bt.onPopupClose(),It.fadeOut(Bt[l],function(){Bt[bt]&&Ft[i](P,z),Xt=a})})[r](_),qt.keydown(function(e){if($t.is(":visible"))switch(e.keyCode){case 37:case 32:if(Bt[J])return $t[r](T),a;break;case 39:if(Bt[J])return $t[r](H),a;break;case 27:return $t[r](f),a}}),jt.find(Bt.selector).each(function(u){var f,l,h,p,d=e(this),v=d.find("img"),g=d.data(it);if(!d.attr(xt))return;f={src:d.attr(xt),captionText:v.attr("title"),width:d.attr(n),height:d.attr(t),type:C,object:C};if(g){p=g.split(",");for(h in p)l=p[h].match(/([0-9]+)x([0-9]+)/),l&&l[c]==3?(f[n]=l[1],f[t]=l[2]):f[wt]=p[h]}if(!f[wt]){l=f.src.match(/http[s]?:\/\/([a-z0-9\.]+)\/.*/);if(!l||l[c]<3)l=[a];switch(l[1]){case"api.soundcloud.com":f[wt]=gt;break;case"youtu.be":f[wt]=Nt;break;case"vimeo.com":f[wt]="vimeo";break;case"wistia.net":f[wt]="wistia";break;default:f[wt]=pt}}l=f.src.match(/http([s]?):\/\/[a-z0-9\.]+\/(.*)/),l&&(f[yt]="http"+(l[1]=="s"?"s":""));switch(f[wt]){case ct:break;case"iframe":f[D]=e('<iframe src="" frameborder="0"></iframe>'),f[D].on(m,function(e){e[o]()})[i](A,z);break;case"ajax":f[D]=e('<div class="poptrox-ajax"></div>'),f[D].on(m,function(e){e[o]()})[i](A,z)[i](P,z);break;case gt:f[D]=e('<iframe scrolling="no" frameborder="no" src=""></iframe>'),f.src=f[yt]+"://w.soundcloud.com/player/?url="+escape(f.src),f[n]="600",f[t]="166";break;case Nt:f[D]=e('<iframe src="" frameborder="0" allowfullscreen="1"></iframe>'),f.src=f[yt]+"://www.youtube.com/embed/"+l[2];break;case"vimeo":f[D]=e(s),f.src=f[yt]+"://player.vimeo.com/video/"+l[2];break;case"wistia":f[D]=e(s),f.src=f[yt]+"://fast.wistia.net/"+l[2];break;default:f[D]=e('<img src="" alt="" style="vertical-align:bottom" />'),Bt.preload&&(l=document.createElement("img"),l.src=f.src,Vt.push(l))}f[wt]!=ct&&zt.push(f),v.attr("title",""),f[wt]!=ct&&d.attr(xt,"")[i](tt,0).on(m,function(e){e[O](),e[o](),$t[r](ut,[u])})}),e(this)}})(jQuery);